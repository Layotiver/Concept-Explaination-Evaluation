Loaded pretrained model /root/autodl-tmp/haoran/SparseAE-pythia-pile/data/cac/models--EleutherAI--pythia-70m/snapshots/a39f36b100fe8a5377810d56c3f4789b9c53ac42 into HookedTransformer
Moving model to device:  cuda:3
n_layers: 6
d_model: 512
n_heads: 8
d_head: 64
d_mlp: 2048
d_model: 512
d_vocab: 50304
Updated config
/root/autodl-tmp/haoran/.conda/envs/py38/lib/python3.8/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by mode='default'.
  table = cls._concat_blocks(blocks, axis=0)

buffer refreshing...
{
  "dict_mult": 8,
  "d_mlp": 2048,
  "d_model": 512,
  "enc_dtype": "fp32",
  "buffer_size": 13107200,
  "buffer_mult": 400,
  "act_size": 512,
  "buffer_batches": 102400,
  "model_batch_size": 256,
  "seed": 90,
  "num_tokens": 1363348000,
  "seq_len": 128,
  "layer": 0,
  "site": "resid_post",
  "layer_type": null,
  "name_only": 0,
  "beta1": 0.9,
  "beta2": 0.99,
  "lr": 0.001,
  "l1_type": "default",
  "l2_type": "KL",
  "num_batches": 41606,
  "device": "cuda:3",
  "batch_size": 32768,
  "l1_coeff": 0.5,
  "epoch": 5,
  "reinit": 0,
  "init_type": "kaiming_uniform",
  "remove_parallel": 1,
  "model_to_interpret": "pythia-70m",
  "data_dir": "/root/autodl-tmp/haoran/SparseAE-pythia-pile/data/",
  "dataset_name": "pile_neel/pile-tokenized-10b.hf",
  "output_dir": "/root/autodl-tmp/haoran/SparseAE-pythia-pile/data/output",
  "subname": "",
  "cache_dir": "/root/autodl-tmp/haoran/SparseAE-pythia-pile/data/cache",
  "model_dir": "/root/autodl-tmp/haoran/SparseAE-pythia-pile/data/cac/models--EleutherAI--pythia-70m/snapshots/a39f36b100fe8a5377810d56c3f4789b9c53ac42",
  "nickname_suffix": "noshuffle_lr_0-001_l1_0-5_epoch_5_reinit_0_initType_kaiming_uniform_seed_90",
  "dict_size": 4096,
  "act_name": "blocks.0.hook_resid_post"
}
cuda:3
epoch: 0

Epoch: 1  Iteration: 100  Total time: 6.404128313064575 s
Finished: 0.240 % of Epoch  0
{'loss': 24.703773498535156, 'l2_loss': 17.015342712402344, 'l1_loss': 7.688429832458496}
loss: 3.6084, recons_loss: 7.1109, zero_abl_loss: 12.3218
Reconstruction Score: 59.80%
get freqs...
get l0 norm...
l0 norm: tensor(83.4028, device='cuda:3')

Epoch: 1  Iteration: 200  Total time: 32.29771184921265 s
Finished: 0.481 % of Epoch  0
{'loss': 19.358718872070312, 'l2_loss': 13.035194396972656, 'l1_loss': 6.323523998260498}
loss: 3.5470, recons_loss: 6.0229, zero_abl_loss: 12.6567
Reconstruction Score: 72.82%
get freqs...
get l0 norm...
l0 norm: tensor(57.5725, device='cuda:3')

Epoch: 1  Iteration: 300  Total time: 59.76059603691101 s
Finished: 0.721 % of Epoch  0
{'loss': 17.019155502319336, 'l2_loss': 10.77949333190918, 'l1_loss': 6.239662170410156}
loss: 3.5625, recons_loss: 5.0452, zero_abl_loss: 11.6716
Reconstruction Score: 81.72%
get freqs...
get l0 norm...
l0 norm: tensor(52.2303, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 400  Total time: 225.88309001922607 s
Finished: 0.961 % of Epoch  0
{'loss': 15.606671333312988, 'l2_loss': 9.392763137817383, 'l1_loss': 6.2139081954956055}
loss: 3.6016, recons_loss: 4.8082, zero_abl_loss: 11.6466
Reconstruction Score: 85.00%
get freqs...
get l0 norm...
l0 norm: tensor(50.0101, device='cuda:3')

Epoch: 1  Iteration: 500  Total time: 247.77191281318665 s
Finished: 1.202 % of Epoch  0
{'loss': 14.940533638000488, 'l2_loss': 8.660112380981445, 'l1_loss': 6.280421257019043}
loss: 3.5957, recons_loss: 4.5479, zero_abl_loss: 12.7045
Reconstruction Score: 89.55%
get freqs...
get l0 norm...
l0 norm: tensor(48.5906, device='cuda:3')

Epoch: 1  Iteration: 600  Total time: 269.7343182563782 s
Finished: 1.442 % of Epoch  0
{'loss': 14.166141510009766, 'l2_loss': 7.957915306091309, 'l1_loss': 6.208226680755615}
loss: 3.5891, recons_loss: 4.4662, zero_abl_loss: 13.1054
Reconstruction Score: 90.78%
get freqs...
get l0 norm...
l0 norm: tensor(47.6356, device='cuda:3')

Epoch: 1  Iteration: 700  Total time: 292.37667202949524 s
Finished: 1.682 % of Epoch  0
{'loss': 13.519739151000977, 'l2_loss': 7.382613182067871, 'l1_loss': 6.137126445770264}
loss: 3.5910, recons_loss: 4.1953, zero_abl_loss: 11.5568
Reconstruction Score: 92.41%
get freqs...
get l0 norm...
l0 norm: tensor(46.4100, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 800  Total time: 453.68995690345764 s
Finished: 1.923 % of Epoch  0
{'loss': 12.781551361083984, 'l2_loss': 6.778035640716553, 'l1_loss': 6.003515720367432}
loss: 3.5495, recons_loss: 4.1105, zero_abl_loss: 12.0985
Reconstruction Score: 93.44%
get freqs...
get l0 norm...
l0 norm: tensor(45.6618, device='cuda:3')

Epoch: 1  Iteration: 900  Total time: 478.2975580692291 s
Finished: 2.163 % of Epoch  0
{'loss': 12.447613716125488, 'l2_loss': 6.507606029510498, 'l1_loss': 5.94000768661499}
loss: 3.5313, recons_loss: 4.0387, zero_abl_loss: 12.4661
Reconstruction Score: 94.32%
get freqs...
get l0 norm...
l0 norm: tensor(44.6785, device='cuda:3')

Epoch: 1  Iteration: 1000  Total time: 505.8134071826935 s
Finished: 2.403 % of Epoch  0
{'loss': 11.909554481506348, 'l2_loss': 6.084936141967773, 'l1_loss': 5.824618339538574}
loss: 3.5892, recons_loss: 4.0414, zero_abl_loss: 12.0817
Reconstruction Score: 94.68%
get freqs...
get l0 norm...
l0 norm: tensor(43.8501, device='cuda:3')

Epoch: 1  Iteration: 1100  Total time: 532.084335565567 s
Finished: 2.644 % of Epoch  0
{'loss': 11.586210250854492, 'l2_loss': 5.853649616241455, 'l1_loss': 5.732560157775879}
loss: 3.6115, recons_loss: 4.0408, zero_abl_loss: 12.1157
Reconstruction Score: 94.95%
get freqs...
get l0 norm...
l0 norm: tensor(42.8102, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 1200  Total time: 696.9257462024689 s
Finished: 2.884 % of Epoch  0
{'loss': 11.320228576660156, 'l2_loss': 5.651174545288086, 'l1_loss': 5.66905403137207}
loss: 3.5974, recons_loss: 3.9824, zero_abl_loss: 12.7077
Reconstruction Score: 95.77%
get freqs...
get l0 norm...
l0 norm: tensor(41.2994, device='cuda:3')

Epoch: 1  Iteration: 1300  Total time: 720.6851511001587 s
Finished: 3.125 % of Epoch  0
{'loss': 10.894458770751953, 'l2_loss': 5.374671936035156, 'l1_loss': 5.519786357879639}
loss: 3.5499, recons_loss: 3.9059, zero_abl_loss: 12.1514
Reconstruction Score: 95.86%
get freqs...
get l0 norm...
l0 norm: tensor(40.4743, device='cuda:3')

Epoch: 1  Iteration: 1400  Total time: 745.4297726154327 s
Finished: 3.365 % of Epoch  0
{'loss': 10.723241806030273, 'l2_loss': 5.2194061279296875, 'l1_loss': 5.503835678100586}
loss: 3.6421, recons_loss: 4.0423, zero_abl_loss: 12.3707
Reconstruction Score: 95.42%
get freqs...
get l0 norm...
l0 norm: tensor(39.0982, device='cuda:3')

Epoch: 1  Iteration: 1500  Total time: 769.9683613777161 s
Finished: 3.605 % of Epoch  0
{'loss': 10.48576545715332, 'l2_loss': 5.1122026443481445, 'l1_loss': 5.373562812805176}
loss: 3.5635, recons_loss: 3.8860, zero_abl_loss: 13.2448
Reconstruction Score: 96.67%
get freqs...
get l0 norm...
l0 norm: tensor(38.2857, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 1600  Total time: 935.4209156036377 s
Finished: 3.846 % of Epoch  0
{'loss': 10.30842399597168, 'l2_loss': 5.002957820892334, 'l1_loss': 5.305466651916504}
loss: 3.5330, recons_loss: 3.8623, zero_abl_loss: 11.9560
Reconstruction Score: 96.09%
get freqs...
get l0 norm...
l0 norm: tensor(37.4352, device='cuda:3')

Epoch: 1  Iteration: 1700  Total time: 960.0090939998627 s
Finished: 4.086 % of Epoch  0
{'loss': 10.218232154846191, 'l2_loss': 4.946323394775391, 'l1_loss': 5.271908760070801}
loss: 3.5666, recons_loss: 3.8870, zero_abl_loss: 11.5822
Reconstruction Score: 96.00%
get freqs...
get l0 norm...
l0 norm: tensor(36.4639, device='cuda:3')

Epoch: 1  Iteration: 1800  Total time: 984.527357339859 s
Finished: 4.326 % of Epoch  0
{'loss': 10.171810150146484, 'l2_loss': 4.928515434265137, 'l1_loss': 5.243294715881348}
loss: 3.5501, recons_loss: 3.8696, zero_abl_loss: 12.2853
Reconstruction Score: 96.34%
get freqs...
get l0 norm...
l0 norm: tensor(35.4755, device='cuda:3')

Epoch: 1  Iteration: 1900  Total time: 1010.503769159317 s
Finished: 4.567 % of Epoch  0
{'loss': 10.067825317382812, 'l2_loss': 4.877132415771484, 'l1_loss': 5.190692901611328}
loss: 3.5780, recons_loss: 3.8968, zero_abl_loss: 12.3322
Reconstruction Score: 96.36%
get freqs...
get l0 norm...
l0 norm: tensor(35.0762, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 2000  Total time: 1178.1239845752716 s
Finished: 4.807 % of Epoch  0
{'loss': 9.967497825622559, 'l2_loss': 4.831249237060547, 'l1_loss': 5.136248588562012}
loss: 3.5796, recons_loss: 3.8925, zero_abl_loss: 12.1707
Reconstruction Score: 96.36%
get freqs...
get l0 norm...
l0 norm: tensor(34.2144, device='cuda:3')

Epoch: 1  Iteration: 2100  Total time: 1201.8370037078857 s
Finished: 5.047 % of Epoch  0
{'loss': 9.933353424072266, 'l2_loss': 4.825470924377441, 'l1_loss': 5.107882976531982}
loss: 3.5930, recons_loss: 3.8956, zero_abl_loss: 12.6532
Reconstruction Score: 96.66%
get freqs...
get l0 norm...
l0 norm: tensor(34.0612, device='cuda:3')

Epoch: 1  Iteration: 2200  Total time: 1225.4076082706451 s
Finished: 5.288 % of Epoch  0
{'loss': 9.962709426879883, 'l2_loss': 4.83684778213501, 'l1_loss': 5.125861167907715}
loss: 3.5643, recons_loss: 3.8841, zero_abl_loss: 12.4365
Reconstruction Score: 96.40%
get freqs...
get l0 norm...
l0 norm: tensor(33.6919, device='cuda:3')

Epoch: 1  Iteration: 2300  Total time: 1248.141832113266 s
Finished: 5.528 % of Epoch  0
{'loss': 10.020638465881348, 'l2_loss': 4.901386260986328, 'l1_loss': 5.1192522048950195}
loss: 3.5669, recons_loss: 3.8674, zero_abl_loss: 11.9284
Reconstruction Score: 96.41%
get freqs...
get l0 norm...
l0 norm: tensor(33.4852, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 2400  Total time: 1413.0770814418793 s
Finished: 5.768 % of Epoch  0
{'loss': 9.937041282653809, 'l2_loss': 4.828840255737305, 'l1_loss': 5.108201026916504}
loss: 3.5211, recons_loss: 3.8445, zero_abl_loss: 12.8338
Reconstruction Score: 96.53%
get freqs...
get l0 norm...
l0 norm: tensor(32.8713, device='cuda:3')

Epoch: 1  Iteration: 2500  Total time: 1438.5516920089722 s
Finished: 6.009 % of Epoch  0
{'loss': 9.904176712036133, 'l2_loss': 4.8498969078063965, 'l1_loss': 5.0542802810668945}
loss: 3.5777, recons_loss: 3.8765, zero_abl_loss: 12.1724
Reconstruction Score: 96.52%
get freqs...
get l0 norm...
l0 norm: tensor(32.8696, device='cuda:3')

Epoch: 1  Iteration: 2600  Total time: 1462.7750730514526 s
Finished: 6.249 % of Epoch  0
{'loss': 9.8785400390625, 'l2_loss': 4.817229270935059, 'l1_loss': 5.061310768127441}
loss: 3.5799, recons_loss: 3.8824, zero_abl_loss: 11.5742
Reconstruction Score: 96.22%
get freqs...
get l0 norm...
l0 norm: tensor(32.5620, device='cuda:3')

Epoch: 1  Iteration: 2700  Total time: 1487.9505848884583 s
Finished: 6.489 % of Epoch  0
{'loss': 9.836406707763672, 'l2_loss': 4.812008380889893, 'l1_loss': 5.024397850036621}
loss: 3.5794, recons_loss: 3.9136, zero_abl_loss: 11.6828
Reconstruction Score: 95.88%
get freqs...
get l0 norm...
l0 norm: tensor(32.3581, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 2800  Total time: 1654.870025396347 s
Finished: 6.730 % of Epoch  0
{'loss': 9.754598617553711, 'l2_loss': 4.767563343048096, 'l1_loss': 4.987034797668457}
loss: 3.5826, recons_loss: 3.8821, zero_abl_loss: 12.7325
Reconstruction Score: 96.73%
get freqs...
get l0 norm...
l0 norm: tensor(32.2120, device='cuda:3')

Epoch: 1  Iteration: 2900  Total time: 1679.1976430416107 s
Finished: 6.970 % of Epoch  0
{'loss': 9.751328468322754, 'l2_loss': 4.769118785858154, 'l1_loss': 4.9822096824646}
loss: 3.5694, recons_loss: 3.8791, zero_abl_loss: 12.1984
Reconstruction Score: 96.41%
get freqs...
get l0 norm...
l0 norm: tensor(31.7550, device='cuda:3')

Epoch: 1  Iteration: 3000  Total time: 1704.3246138095856 s
Finished: 7.210 % of Epoch  0
{'loss': 9.743614196777344, 'l2_loss': 4.761415004730225, 'l1_loss': 4.982199668884277}
loss: 3.5919, recons_loss: 3.8827, zero_abl_loss: 11.5827
Reconstruction Score: 96.36%
get freqs...
get l0 norm...
l0 norm: tensor(31.6655, device='cuda:3')

Epoch: 1  Iteration: 3100  Total time: 1728.3988268375397 s
Finished: 7.451 % of Epoch  0
{'loss': 9.755422592163086, 'l2_loss': 4.780524253845215, 'l1_loss': 4.974897861480713}
loss: 3.5464, recons_loss: 3.8554, zero_abl_loss: 12.0327
Reconstruction Score: 96.36%
get freqs...
get l0 norm...
l0 norm: tensor(31.7038, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 3200  Total time: 1891.5000545978546 s
Finished: 7.691 % of Epoch  0
{'loss': 9.810735702514648, 'l2_loss': 4.803583145141602, 'l1_loss': 5.007152557373047}
loss: 3.5461, recons_loss: 3.8832, zero_abl_loss: 11.8777
Reconstruction Score: 95.95%
get freqs...
get l0 norm...
l0 norm: tensor(31.5333, device='cuda:3')

Epoch: 1  Iteration: 3300  Total time: 1917.467482805252 s
Finished: 7.932 % of Epoch  0
{'loss': 9.747163772583008, 'l2_loss': 4.7902069091796875, 'l1_loss': 4.95695686340332}
loss: 3.5859, recons_loss: 3.9088, zero_abl_loss: 12.9712
Reconstruction Score: 96.56%
get freqs...
get l0 norm...
l0 norm: tensor(31.3831, device='cuda:3')

Epoch: 1  Iteration: 3400  Total time: 1943.1092104911804 s
Finished: 8.172 % of Epoch  0
{'loss': 9.762657165527344, 'l2_loss': 4.786818981170654, 'l1_loss': 4.9758381843566895}
loss: 3.5348, recons_loss: 3.8572, zero_abl_loss: 12.8388
Reconstruction Score: 96.53%
get freqs...
get l0 norm...
l0 norm: tensor(31.4437, device='cuda:3')

Epoch: 1  Iteration: 3500  Total time: 1968.9232845306396 s
Finished: 8.412 % of Epoch  0
{'loss': 9.755370140075684, 'l2_loss': 4.793813705444336, 'l1_loss': 4.961556434631348}
loss: 3.5558, recons_loss: 3.8657, zero_abl_loss: 11.6211
Reconstruction Score: 96.16%
get freqs...
get l0 norm...
l0 norm: tensor(31.2093, device='cuda:3')

buffer refreshing...

Epoch: 1  Iteration: 3600  Total time: 2132.9519448280334 s
Finished: 8.653 % of Epoch  0
{'loss': 9.628752708435059, 'l2_loss': 4.724269866943359, 'l1_loss': 4.904482841491699}
loss: 3.5723, recons_loss: 3.8830, zero_abl_loss: 12.2589
Reconstruction Score: 96.42%
get freqs...
get l0 norm...
l0 norm: tensor(30.9248, device='cuda:3')

Epoch: 1  Iteration: 3700  Total time: 2154.1460916996 s
Finished: 8.893 % of Epoch  0
{'loss': 9.675975799560547, 'l2_loss': 4.747505187988281, 'l1_loss': 4.928470611572266}
loss: 3.6225, recons_loss: 3.9172, zero_abl_loss: 11.9344
Reconstruction Score: 96.46%
get freqs...
get l0 norm...
l0 norm: tensor(30.9885, device='cuda:3')

Epoch: 1  Iteration: 3800  Total time: 2179.051377058029 s
Finished: 9.133 % of Epoch  0
{'loss': 9.746102333068848, 'l2_loss': 4.783263206481934, 'l1_loss': 4.962839126586914}
loss: 3.5961, recons_loss: 3.9013, zero_abl_loss: 11.8410
Reconstruction Score: 96.30%
get freqs...
get l0 norm...
l0 norm: tensor(30.8061, device='cuda:3')
